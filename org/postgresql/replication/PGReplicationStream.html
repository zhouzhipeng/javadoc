<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (1.8.0_112) on Sat Sep 01 15:36:13 CST 2018 -->
<title>PGReplicationStream</title>
<meta name="date" content="2018-09-01">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PGReplicationStream";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6};
var tabs = {65535:["t0","所有方法"],2:["t2","实例方法"],4:["t3","抽象方法"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.postgresql.replication</div>
<h2 title="接口 PGReplicationStream" class="title">接口 PGReplicationStream</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>所有已知实现类:</dt>
<dd><a href="../../../org/postgresql/core/v3/replication/V3PGReplicationStream.html" title="org.postgresql.core.v3.replication中的类">V3PGReplicationStream</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">PGReplicationStream</span></pre>
<div class="block">Not tread safe replication stream. After complete streaming should be close, for free resource on
 backend. Periodical status update work only when use <a href="../../../org/postgresql/replication/PGReplicationStream.html#read--"><code>read()</code></a> method.
 It means that process wal record should be fast as possible, because during process wal record
 lead to disconnect by timeout from server.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span id="t0" class="activeTableTab"><span>所有方法</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">实例方法</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">抽象方法</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#close--">close</a></span>()</code>
<div class="block">Stop replication changes from server and free resources.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#forceUpdateStatus--">forceUpdateStatus</a></span>()</code>
<div class="block">Force send to backend status about last received, flushed and applied LSN.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#getLastAppliedLSN--">getLastAppliedLSN</a></span>()</code>
<div class="block">Last applied lsn send in update message to backed.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#getLastFlushedLSN--">getLastFlushedLSN</a></span>()</code>
<div class="block">Last flushed lsn send in update message to backend.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#getLastReceiveLSN--">getLastReceiveLSN</a></span>()</code>
<div class="block">Parameter updates by execute <a href="../../../org/postgresql/replication/PGReplicationStream.html#read--"><code>read()</code></a> method.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#isClosed--">isClosed</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="java.nio中的类或接口">ByteBuffer</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#read--">read</a></span>()</code>
<div class="block">Read next wal record from backend.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="java.nio中的类或接口">ByteBuffer</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#readPending--">readPending</a></span>()</code>
<div class="block">Read next wal record from backend.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#setAppliedLSN-org.postgresql.replication.LogSequenceNumber-">setAppliedLSN</a></span>(<a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a>&nbsp;applied)</code>
<div class="block">Parameter used only physical replication and define which lsn already was apply on standby.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/postgresql/replication/PGReplicationStream.html#setFlushedLSN-org.postgresql.replication.LogSequenceNumber-">setFlushedLSN</a></span>(<a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a>&nbsp;flushed)</code>
<div class="block">Set flushed LSN.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="read--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre><a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="java.nio中的类或接口">ByteBuffer</a>&nbsp;read()
         throws <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></pre>
<div class="block"><p>Read next wal record from backend. It method can be block until new message will not get
 from server.

 <p>A single WAL record is never split across two XLogData messages. When a WAL record crosses a
 WAL page boundary, and is therefore already split using continuation records, it can be split
 at the page boundary. In other words, the first main WAL record and its continuation records
 can be sent in different XLogData messages.</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>not null byte array received by replication protocol, return ByteBuffer wrap around
 received byte array with use offset, so, use <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true#array--" title="java.nio中的类或接口"><code>ByteBuffer.array()</code></a> carefully</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></code> - when some internal exception occurs during read from stream</dd>
</dl>
</li>
</ul>
<a name="readPending--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readPending</h4>
<pre><a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="java.nio中的类或接口">ByteBuffer</a>&nbsp;readPending()
                throws <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></pre>
<div class="block"><p>Read next wal record from backend. It method can't be block and in contrast to <a href="../../../org/postgresql/replication/PGReplicationStream.html#read--"><code>read()</code></a>. If message from backend absent return null. It allow periodically
 check message in stream and if they absent sleep some time, but it time should be less than
 <a href="../../../org/postgresql/replication/fluent/CommonOptions.html#getStatusInterval--"><code>CommonOptions.getStatusInterval()</code></a> to avoid disconnect from the server.

 <p>A single WAL record is never split across two XLogData messages. When a WAL record crosses a
 WAL page boundary, and is therefore already split using continuation records, it can be split
 at the page boundary. In other words, the first main WAL record and its continuation records
 can be sent in different XLogData messages.</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>byte array received by replication protocol or null if pending message from server
 absent. Returns ByteBuffer wrap around received byte array with use offset, so, use <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true#array--" title="java.nio中的类或接口"><code>ByteBuffer.array()</code></a> carefully.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></code> - when some internal exception occurs during read from stream</dd>
</dl>
</li>
</ul>
<a name="getLastReceiveLSN--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastReceiveLSN</h4>
<pre><a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a>&nbsp;getLastReceiveLSN()</pre>
<div class="block">Parameter updates by execute <a href="../../../org/postgresql/replication/PGReplicationStream.html#read--"><code>read()</code></a> method.</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>not null LSN position that was receive last time via <a href="../../../org/postgresql/replication/PGReplicationStream.html#read--"><code>read()</code></a>
 method</dd>
</dl>
</li>
</ul>
<a name="getLastFlushedLSN--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastFlushedLSN</h4>
<pre><a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a>&nbsp;getLastFlushedLSN()</pre>
<div class="block">Last flushed lsn send in update message to backend. Parameter updates only via <a href="../../../org/postgresql/replication/PGReplicationStream.html#setFlushedLSN-org.postgresql.replication.LogSequenceNumber-"><code>setFlushedLSN(LogSequenceNumber)</code></a></div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>not null location of the last WAL flushed to disk in the standby.</dd>
</dl>
</li>
</ul>
<a name="getLastAppliedLSN--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastAppliedLSN</h4>
<pre><a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a>&nbsp;getLastAppliedLSN()</pre>
<div class="block">Last applied lsn send in update message to backed. Parameter updates only via <a href="../../../org/postgresql/replication/PGReplicationStream.html#setAppliedLSN-org.postgresql.replication.LogSequenceNumber-"><code>setAppliedLSN(LogSequenceNumber)</code></a></div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>not null location of the last WAL applied in the standby.</dd>
</dl>
</li>
</ul>
<a name="setFlushedLSN-org.postgresql.replication.LogSequenceNumber-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setFlushedLSN</h4>
<pre>void&nbsp;setFlushedLSN(<a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a>&nbsp;flushed)</pre>
<div class="block">Set flushed LSN. It parameter will be send to backend on next update status iteration. Flushed
 LSN position help backend define which wal can be recycle.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>flushed</code> - not null location of the last WAL flushed to disk in the standby.</dd>
<dt><span class="seeLabel">另请参阅:</span></dt>
<dd><a href="../../../org/postgresql/replication/PGReplicationStream.html#forceUpdateStatus--"><code>forceUpdateStatus()</code></a></dd>
</dl>
</li>
</ul>
<a name="setAppliedLSN-org.postgresql.replication.LogSequenceNumber-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAppliedLSN</h4>
<pre>void&nbsp;setAppliedLSN(<a href="../../../org/postgresql/replication/LogSequenceNumber.html" title="org.postgresql.replication中的类">LogSequenceNumber</a>&nbsp;applied)</pre>
<div class="block">Parameter used only physical replication and define which lsn already was apply on standby.
 Feedback will send to backend on next update status iteration.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>applied</code> - not null location of the last WAL applied in the standby.</dd>
<dt><span class="seeLabel">另请参阅:</span></dt>
<dd><a href="../../../org/postgresql/replication/PGReplicationStream.html#forceUpdateStatus--"><code>forceUpdateStatus()</code></a></dd>
</dl>
</li>
</ul>
<a name="forceUpdateStatus--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>forceUpdateStatus</h4>
<pre>void&nbsp;forceUpdateStatus()
                throws <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></pre>
<div class="block">Force send to backend status about last received, flushed and applied LSN. You can not use it
 method explicit, because <a href="../../../org/postgresql/replication/PGReplicationStream.html" title="org.postgresql.replication中的接口"><code>PGReplicationStream</code></a> send status to backend periodical by
 configured interval via <a href="../../../org/postgresql/replication/fluent/CommonOptions.html#getStatusInterval--"><code>CommonOptions.getStatusInterval()</code></a></div>
<dl>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></code> - when some internal exception occurs during read from stream</dd>
<dt><span class="seeLabel">另请参阅:</span></dt>
<dd><a href="../../../org/postgresql/replication/fluent/CommonOptions.html#getStatusInterval--"><code>CommonOptions.getStatusInterval()</code></a></dd>
</dl>
</li>
</ul>
<a name="isClosed--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isClosed</h4>
<pre>boolean&nbsp;isClosed()</pre>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd><code>true</code> if replication stream was already close, otherwise return <code>false</code></dd>
</dl>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>close</h4>
<pre>void&nbsp;close()
    throws <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></pre>
<div class="block"><p>Stop replication changes from server and free resources. After that connection can be reuse
 to another queries. Also after close current stream they cannot be used anymore.

 <p><b>Note:</b> This method can spend much time for logical replication stream on postgresql
 version 9.6 and lower, because postgresql have bug - during decode big transaction to logical
 form and during wait new changes postgresql ignore messages from client. As workaround you can
 close replication connection instead of close replication stream. For more information about it
 problem see mailing list thread <a href="http://www.postgresql.org/message-id/CAFgjRd3hdYOa33m69TbeOfNNer2BZbwa8FFjt2V5VFzTBvUU3w@mail.gmail.com">
 Stopping logical replication protocol</a></div>
<dl>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/sql/SQLException.html?is-external=true" title="java.sql中的类或接口">SQLException</a></code> - when some internal exception occurs during end streaming</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</body>
</html>
